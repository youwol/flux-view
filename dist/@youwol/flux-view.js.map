{"version":3,"sources":["webpack://@youwol/flux-view/webpack/universalModuleDefinition","webpack://@youwol/flux-view/webpack/bootstrap","webpack://@youwol/flux-view/external {\"commonjs\":\"rxjs/operators\",\"commonjs2\":\"rxjs/operators\",\"root\":[\"rxjs\",\"operators\"]}","webpack://@youwol/flux-view/./lib/stream$.ts","webpack://@youwol/flux-view/./lib/factory.ts","webpack://@youwol/flux-view/./lib/core.ts"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","stream$","map","untilFirst","wrapper","sideEffects","fct","withData","pipe","args","finalize","subscribe","v","vWrapped","v1","vDomMap","data","child$","attr$","CustomElementsMap","HTMLAnchorElement","HTMLElement","HTMLAreaElement","HTMLAudioElement","HTMLBaseElement","HTMLQuoteElement","HTMLBodyElement","HTMLBRElement","HTMLButtonElement","HTMLCanvasElement","HTMLTableCaptionElement","HTMLTableColElement","HTMLDataElement","HTMLDataListElement","HTMLModElement","HTMLDetailsElement","HTMLDialogElement","HTMLDirectoryElement","HTMLDivElement","HTMLDListElement","HTMLEmbedElement","HTMLFieldSetElement","HTMLFontElement","HTMLFormElement","HTMLFrameElement","HTMLFrameSetElement","HTMLHeadingElement","HTMLHeadElement","HTMLHRElement","HTMLHtmlElement","HTMLIFrameElement","HTMLImageElement","HTMLInputElement","HTMLLabelElement","HTMLLegendElement","HTMLLIElement","HTMLLinkElement","HTMLMapElement","HTMLMarqueeElement","HTMLMenuElement","HTMLMetaElement","HTMLMeterElement","HTMLObjectElement","HTMLOListElement","HTMLOptGroupElement","HTMLOptionElement","HTMLOutputElement","HTMLParagraphElement","HTMLParamElement","HTMLPictureElement","HTMLPreElement","HTMLProgressElement","HTMLScriptElement","HTMLSelectElement","HTMLSlotElement","HTMLSourceElement","HTMLSpanElement","HTMLStyleElement","HTMLTableElement","HTMLTableSectionElement","HTMLTableCellElement","HTMLTemplateElement","HTMLTextAreaElement","HTMLTimeElement","HTMLTitleElement","HTMLTableRowElement","HTMLTrackElement","HTMLUListElement","HTMLVideoElement","_$","HTMLPlaceHolderElement","super","currentElement","apply","vDom","div","render","replaceWith","specialBindings","class","instance","className","style","entries","forEach","k","Base","subscriptions","Array","attributes","filter","attributes$","applyAttribute","push","children","child","placeHolder","document","createElement","appendChild","initialize","unsubscribe","element","tag","Error","is","customElements","HTMLElementClass","BaseClass","ExtendedClass$","extends","registerElement"],"mappings":"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","file":"@youwol/flux-view.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"rxjs/operators\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@youwol/flux-view\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@youwol/flux-view\"] = factory(require(\"rxjs/operators\"));\n\telse\n\t\troot[\"@youwol/flux-view\"] = factory(root[\"rxjs\"][\"operators\"]);\n})((typeof self !== 'undefined' ? self : this), function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","import { Observable } from \"rxjs\"\nimport { map } from \"rxjs/operators\"\n\n\nexport class Stream$<T0, T1 = T0> {\n\n    public readonly untilFirst\n    public readonly wrapper\n    public readonly sideEffects\n\n    constructor(\n        public readonly stream$: Observable<T0>,\n        public readonly map:  (T0,...args:any[])=>T1,\n        { untilFirst, wrapper, sideEffects }: \n        { untilFirst?: T1, wrapper?: (T1) => T1 , \n          sideEffects?: (T1, T0) => void } ) {\n\n        this.untilFirst = untilFirst\n        this.wrapper = wrapper\n        this.map = map\n        this.sideEffects = sideEffects\n    }\n\n    subscribe( fct : (T,...args:any[]) => any, ...withData ) {\n\n        let stream$ = this.stream$.pipe( map( (d: any, ...args:any[]) => this.map(d,...withData) ))\n        \n        this.untilFirst && this.finalize(fct,  this.untilFirst )\n        \n        return stream$.subscribe( (v:T1) => {\n            this.finalize(fct, v )\n        })\n    }\n    \n    private finalize(fct : (T,...args:any[]) => any, value: T1){\n        let vWrapped = this.wrapper ? this.wrapper(value) : value\n        let v1 = fct(vWrapped)\n        this.sideEffects && this.sideEffects(vWrapped, v1)\n    }\n}\n\n\nfunction stream$<TDomain,TDom>(\n    stream$: Observable<TDomain>,\n    vDomMap: (TDomain, ...args: any[]) => TDom,\n    { untilFirst, wrapper, sideEffects }: \n    { untilFirst?: TDom, wrapper?: (TDom) => TDom, sideEffects?: (TDomain, HTMLElement) => void  } = {},\n      ){\n\n    return new Stream$<TDomain, TDom>(\n        stream$, \n        (data: TDomain, ...args:any[]) => vDomMap(data, ...args),\n        {untilFirst, wrapper, sideEffects })\n}\n\nexport type AttributeType = number | string | boolean | {[key:string]:  number | string | boolean }\n\nexport let child$ = stream$ // this would be type specialization for TDom = VirtualDom\nexport let attr$ = stream$  // this would be type specialization for TDom = AttributeType\n","\n// taken from lib.dom.ts HTMLElementTagNameMap\n\nexport let CustomElementsMap = {\n    \"a\": HTMLAnchorElement,\n    \"abbr\": HTMLElement,\n    \"address\": HTMLElement,\n    //\"applet\": HTMLAppletElement, => got undefined\n    \"area\": HTMLAreaElement,\n    \"article\": HTMLElement,\n    \"aside\": HTMLElement,\n    \"audio\": HTMLAudioElement,\n    \"b\": HTMLElement,\n    \"base\": HTMLBaseElement,\n    //\"basefont\": HTMLBaseFontElement, => got undefined\n    \"bdi\": HTMLElement,\n    \"bdo\": HTMLElement,\n    \"blockquote\": HTMLQuoteElement,\n    \"body\": HTMLBodyElement,\n    \"br\": HTMLBRElement,\n    \"button\": HTMLButtonElement,\n    \"canvas\": HTMLCanvasElement,\n    \"caption\": HTMLTableCaptionElement,\n    \"cite\": HTMLElement,\n    \"code\": HTMLElement,\n    \"col\": HTMLTableColElement,\n    \"colgroup\": HTMLTableColElement,\n    \"data\": HTMLDataElement,\n    \"datalist\": HTMLDataListElement,\n    \"dd\": HTMLElement,\n    \"del\": HTMLModElement,\n    \"details\": HTMLDetailsElement,\n    \"dfn\": HTMLElement,\n    \"dialog\": HTMLDialogElement,\n    \"dir\": HTMLDirectoryElement,\n    \"div\": HTMLDivElement,\n    \"dl\": HTMLDListElement,\n    \"dt\": HTMLElement,\n    \"em\": HTMLElement,\n    \"embed\": HTMLEmbedElement,\n    \"fieldset\": HTMLFieldSetElement,\n    \"figcaption\": HTMLElement,\n    \"figure\": HTMLElement,\n    \"font\": HTMLFontElement,\n    \"footer\": HTMLElement,\n    \"form\": HTMLFormElement,\n    \"frame\": HTMLFrameElement,\n    \"frameset\": HTMLFrameSetElement,\n    \"h1\": HTMLHeadingElement,\n    \"h2\": HTMLHeadingElement,\n    \"h3\": HTMLHeadingElement,\n    \"h4\": HTMLHeadingElement,\n    \"h5\": HTMLHeadingElement,\n    \"h6\": HTMLHeadingElement,\n    \"head\": HTMLHeadElement,\n    \"header\": HTMLElement,\n    \"hgroup\": HTMLElement,\n    \"hr\": HTMLHRElement,\n    \"html\": HTMLHtmlElement,\n    \"i\": HTMLElement,\n    \"iframe\": HTMLIFrameElement,\n    \"img\": HTMLImageElement,\n    \"input\": HTMLInputElement,\n    \"ins\": HTMLModElement,\n    \"kbd\": HTMLElement,\n    \"label\": HTMLLabelElement,\n    \"legend\": HTMLLegendElement,\n    \"li\": HTMLLIElement,\n    \"link\": HTMLLinkElement,\n    \"main\": HTMLElement,\n    \"map\": HTMLMapElement,\n    \"mark\": HTMLElement,\n    \"marquee\": HTMLMarqueeElement,\n    \"menu\": HTMLMenuElement,\n    \"meta\": HTMLMetaElement,\n    \"meter\": HTMLMeterElement,\n    \"nav\": HTMLElement,\n    \"noscript\": HTMLElement,\n    \"object\": HTMLObjectElement,\n    \"ol\": HTMLOListElement,\n    \"optgroup\": HTMLOptGroupElement,\n    \"option\": HTMLOptionElement,\n    \"output\": HTMLOutputElement,\n    \"p\": HTMLParagraphElement,\n    \"param\": HTMLParamElement,\n    \"picture\": HTMLPictureElement,\n    \"pre\": HTMLPreElement,\n    \"progress\": HTMLProgressElement,\n    \"q\": HTMLQuoteElement,\n    \"rp\": HTMLElement,\n    \"rt\": HTMLElement,\n    \"ruby\": HTMLElement,\n    \"s\": HTMLElement,\n    \"samp\": HTMLElement,\n    \"script\": HTMLScriptElement,\n    \"section\": HTMLElement,\n    \"select\": HTMLSelectElement,\n    \"slot\": HTMLSlotElement,\n    \"small\": HTMLElement,\n    \"source\": HTMLSourceElement,\n    \"span\": HTMLSpanElement,\n    \"strong\": HTMLElement,\n    \"style\": HTMLStyleElement,\n    \"sub\": HTMLElement,\n    \"summary\": HTMLElement,\n    \"sup\": HTMLElement,\n    \"table\": HTMLTableElement,\n    \"tbody\": HTMLTableSectionElement,\n    \"td\": HTMLTableCellElement, //should have been : HTMLTableDataCellElement => but get undefined, HTMLTableCellElement is the parent class\n    \"template\": HTMLTemplateElement,\n    \"textarea\": HTMLTextAreaElement,\n    \"tfoot\": HTMLTableSectionElement,\n    \"th\": HTMLTableCellElement, //should have been : HTMLTableHeaderCellElement  => but get undefined, HTMLTableCellElement is the parent class\n    \"thead\": HTMLTableSectionElement,\n    \"time\": HTMLTimeElement,\n    \"title\": HTMLTitleElement,\n    \"tr\": HTMLTableRowElement,\n    \"track\": HTMLTrackElement,\n    \"u\": HTMLElement,\n    \"ul\": HTMLUListElement,\n    \"var\": HTMLElement,\n    \"video\": HTMLVideoElement,\n    \"wbr\": HTMLElement\n}","import { Subscription } from \"rxjs\";\nimport { CustomElementsMap} from \"./factory\";\nimport { AttributeType, Stream$ } from \"./stream$\";\n\n\n\nexport interface VirtualDOM{\n\n    tag?: string\n    [key:string]: any\n}\n\n\nclass HTMLElement$ extends _$(HTMLElement){\n}\n\n\nclass HTMLPlaceHolderElement extends HTMLElement{\n\n    private currentElement: HTMLElement\n    constructor() {\n        super();\n    }\n\n    initialize( stream$: Stream$<VirtualDOM> ): Subscription {\n\n        this.currentElement = this\n\n        let apply = (vDom:VirtualDOM) => {\n            let div = render(vDom)\n            this.currentElement.replaceWith(div)\n            this.currentElement = div\n            return div\n        }\n        \n        return stream$.subscribe( (vDom:VirtualDOM) => { return apply(vDom) })\n    }\n}\n\n\n\ntype Constructor<T extends HTMLElement> = new (...args: any[]) => T;\n\n\nconst specialBindings = {\n    class: (instance, value) => instance.className = value,\n    style: (instance: HTMLElement, value) => {\n        Object.entries(value).forEach( ([k,v]) => instance.style[k] = v )\n    }\n}\n\nfunction _$<T extends Constructor<HTMLElement>>(Base: T) {\n\n    return class extends Base {\n\n        vDom: VirtualDOM;\n        subscriptions = new Array<Subscription>()\n\n        constructor(...args: any[]) {\n            super(...args);\n        }\n\n        initialize(vDom: VirtualDOM){\n            this.vDom = vDom\n        }\n        connectedCallback() {\n\n            let attributes = Object.entries(this.vDom).filter( ([k,v]) => k != 'children' && !(v instanceof  Stream$))\n            let attributes$ = Object.entries(this.vDom).filter( ([k,v]) => k != 'children' && (v instanceof  Stream$))\n\n            attributes.forEach( ([k,v]:[k:string, v:any]) => {\n                this.applyAttribute(k,v)\n            })\n            attributes$.forEach( ([k,attr$]:[k:string, attr$:Stream$<AttributeType>]) => {\n                this.subscriptions.push(\n                    attr$.subscribe( (v) => this.applyAttribute(k,v) , this ) \n                )\n            })\n\n            this.vDom.children && this.vDom.children.forEach( (child) => {\n    \n                if(child instanceof Stream$){\n                    let placeHolder = document.createElement('fv-placeholder') as HTMLPlaceHolderElement\n                    this.appendChild(placeHolder)\n                    this.subscriptions.push( \n                        placeHolder.initialize(child) \n                    )\n                }  \n                else{  \n                    let div = render(child)\n                    this.appendChild(div)\n                }\n            })\n        };\n\n        disconnectedCallback() {\n            this.subscriptions.forEach( s => s.unsubscribe())\n        }\n\n        private applyAttribute(name: string, value: AttributeType){\n\n            specialBindings[name] \n                ? specialBindings[name](this, value) \n                : this[name] = value\n        }\n    }\n}\n\n\nfunction factory(tag: string = 'div'):  HTMLElement${\n\n    if(!CustomElementsMap[tag])\n        throw Error(`The element ${tag} is not registered in flux-view's factory`)\n\n    let div = document.createElement(tag,{ is:`fv-${tag}` } ) as any\n    return div as  HTMLElement$\n}\n\n\nexport function render( vDom:VirtualDOM ) :  HTMLElement$ {\n\n    let element = factory(vDom.tag)\n    element.initialize(vDom)\n    return element\n}\n\n\nfunction registerElement( tag: string, BaseClass ){\n\n    class ExtendedClass$ extends _$(BaseClass){\n        constructor() {super();}\n    }\n    customElements.define( `fv-${tag}`, ExtendedClass$ as any, { extends: tag })    \n}\n\nfunction register() {\n    \n    customElements.define('fv-placeholder', HTMLPlaceHolderElement);\n    \n    Object.entries(CustomElementsMap).forEach( ([tag, HTMLElementClass]) => {\n       registerElement(tag, HTMLElementClass)\n    }) \n}\n\nregister()\n"],"sourceRoot":""}